
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Jacob's Redis 技术与实战教程">
      
      
        <meta name="author" content="Jacob Xi">
      
      
      <link rel="icon" href="../../images/logo.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.2.5">
    
    
      
        <title>Redis 基础你掌握多少了？来个查漏补缺 - Jacob Redis Book</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2d9f7617.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
          
          
          <meta name="theme-color" content="#e92063">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="pink" data-md-color-accent="pink">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#redis" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="Jacob Redis Book" class="md-header__button md-logo" aria-label="Jacob Redis Book" data-md-component="logo">
      
  <img src="../../images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Jacob Redis Book
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Redis 基础你掌握多少了？来个查漏补缺
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="清空当前内容" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Chao-Xi/jxredisbook.git/" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    jxredisbook
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Jacob Redis Book" class="md-nav__button md-logo" aria-label="Jacob Redis Book" data-md-component="logo">
      
  <img src="../../images/logo.png" alt="logo">

    </a>
    Jacob Redis Book
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Chao-Xi/jxredisbook.git/" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    jxredisbook
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Welcome
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          第一章 Redis介绍
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="第一章 Redis介绍" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          第一章 Redis介绍
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap1/1redis_intro/" class="md-nav__link">
        第一节 Redis 不得不去掌握的关键
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          第二章 Redis基础篇
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="第二章 Redis基础篇" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          第二章 Redis基础篇
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap2/1redis_kv/" class="md-nav__link">
        第一节 基本架构： 键值数据库
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap2/2redis_slowquery/" class="md-nav__link">
        第二节 数据结构：Redis为什么那么快？
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap2/3redis_io/" class="md-nav__link">
        第三节 高性能IO模型：Redis为什么那么快？
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap2/4redis_aof_log/" class="md-nav__link">
        第四节 Redis宕机，如何避免数据丢失：AOF日志
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap2/5redis_rdb_snapshot/" class="md-nav__link">
        第五节 Redis宕机，Redis如何实现快速恢复RDB
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap2/6redis_master_slave_replicate/" class="md-nav__link">
        第六节 数据同步：主从库数据一致
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap2/7redis_master_rescue/" class="md-nav__link">
        第七节	哨兵机制：主库不间断服务
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap2/8redis_sentinel/" class="md-nav__link">
        第八节	哨兵集群：哨兵挂了，主从库切换
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap2/9redis_slot/" class="md-nav__link">
        第九节 切片集群：数据增多了，是该加内存还是加实例
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap2/10redis_basic_sum/" class="md-nav__link">
        第二章 Redis核心技术基础总结篇
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          第三章 Redis数据结构
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="第三章 Redis数据结构" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          第三章 Redis数据结构
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap3/1redis_string/" class="md-nav__link">
        第一节 Redis的String类型数据结构
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap3/2redis_sets/" class="md-nav__link">
        第二节 Redis有那些数据结构适合做统计
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap3/3redis_geo/" class="md-nav__link">
        第三节 GEO，一种可以实现LBS服务的数据结构
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap3/4redis_timeseries/" class="md-nav__link">
        第四节 根据时间序列数据的特点，选择合适的存储方案
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap3/5redis_stream/" class="md-nav__link">
        第五节 如何使用redis实现消息队列的需求
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap3/6redis_ds_sum/" class="md-nav__link">
        第三章 Redis 的数据结构
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          第四章 Redis性能影响因子
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="第四章 Redis性能影响因子" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          第四章 Redis性能影响因子
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap4/1redis_asyn/" class="md-nav__link">
        第一节 Redis有哪些可能导致阻塞的操作
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap4/2redis_cpu/" class="md-nav__link">
        第二节 在多核CPU架构和NUMA架构下对redis进行优化配置
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap4/3redis_response/" class="md-nav__link">
        第三节 当redis查询变慢了怎么办？
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap4/4redis_fragmentation/" class="md-nav__link">
        第四节 删除数据后，内存占用率还是很高
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap4/5redis_buffer/" class="md-nav__link">
        第五节 Redis缓冲区
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap4/6redis_slow_respone/" class="md-nav__link">
        第四章 Redis 影响性能的潜在因素
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          第五章 Redis缓存介绍
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="第五章 Redis缓存介绍" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          第五章 Redis缓存介绍
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap5/1redis_cache/" class="md-nav__link">
        第一节 Redis 旁路缓存
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap5/2redis_cache_full/" class="md-nav__link">
        第二节 缓存满后的替换策略
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap5/3redis_mysql_uncon/" class="md-nav__link">
        第三节 如何解决缓存和数据库的数据不一致的缓存异常
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap5/4redis_contamination/" class="md-nav__link">
        第四节 缓存被污染的解决问题
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap5/5redis_cache_summary/" class="md-nav__link">
        第五章 Redis 缓存总结
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          第六章 Redis性能与锁机制以及ACID
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="第六章 Redis性能与锁机制以及ACID" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          第六章 Redis性能与锁机制以及ACID
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap6/1redis_pika_ssd/" class="md-nav__link">
        第一节 基于SSD实现大容量Redis:Pika
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap6/2redis_locks/" class="md-nav__link">
        第二节 Redis应对并发访问：无锁的原子操作
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap6/3redis_distributed_locks/" class="md-nav__link">
        第三节 Redis实现分布式锁
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap6/4redis_acid/" class="md-nav__link">
        第四节 事务机制 Redis实现ACID属性
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap6/5redis_perf/" class="md-nav__link">
        第六章 Redis性能与锁机制以及ACID总结
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          第七章 Redis Cluster集群介绍及管理
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="第七章 Redis Cluster集群介绍及管理" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          第七章 Redis Cluster集群介绍及管理
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap7/1Redis_master_slave/" class="md-nav__link">
        第一节 Redis主从同步与故障切换的三个坑
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap7/2redis_brain_split/" class="md-nav__link">
        第二节 脑裂导致数据丢失
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap7/3redis_codis_cluster/" class="md-nav__link">
        第三节 Redis Codis 集群方案
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap7/4redis_spike_sys/" class="md-nav__link">
        第四节 Redis支撑秒杀场景的关键技术和实践
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap7/5redis_data_incline/" class="md-nav__link">
        第五节 数据分布优化应对数据倾斜
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap7/6redis_cluster_gossip/" class="md-nav__link">
        第六节 限制Redis Cluster规模的关键因素:通信开销
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap7/8Redis_HA/" class="md-nav__link">
        第七节 Redis 高可用性解决方案
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap7/7Redis_cluster_summary/" class="md-nav__link">
        第七章 Redis Cluster集群介绍及管理
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          第八章 Redis学习与操作
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="第八章 Redis学习与操作" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          第八章 Redis学习与操作
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap8/1redis_6.0_fea/" class="md-nav__link">
        第一节 Redis 6.0的新特性：多线程、客户端缓存与安全
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap8/2redis_nvm_mem/" class="md-nav__link">
        第二节 Redis 基于NVM内存的实践
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap8/3redis_RESP/" class="md-nav__link">
        第三节 Redis客户端如何与服务器端交换命令和数据 RESP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap8/4redis_opt_tools/" class="md-nav__link">
        第四节 Redis运维工具
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap8/5redis_protocol/" class="md-nav__link">
        第五节 Redis的使用规范
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap8/8redis_keys/" class="md-nav__link">
        第六节 Redis如何删除数量过万以上Key而不影响业务
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap8/6redis_opt_summary/" class="md-nav__link">
        第八章 Redis学习与操作总结
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap8/7redis_shake/" class="md-nav__link">
        工具补充1：redis-shake数据同步和数据迁移
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10">
          第九章 使用k8s安装Redis集群
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="第九章 使用k8s安装Redis集群" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          第九章 使用k8s安装Redis集群
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap9/1redis_k8s_sts/" class="md-nav__link">
        第一节 Kubernetes上通过sts测试Redis Cluster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chap9/2redis_k8s_config/" class="md-nav__link">
        第二节 利用ConfigMap设置安装 Redis
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11" type="checkbox" id="__nav_11" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_11">
          第十章 期末总结章
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="第十章 期末总结章" data-md-level="1">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          第十章 期末总结章
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1redis_test/" class="md-nav__link">
        Redis 核心技术考题
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Redis 基础你掌握多少了？来个查漏补缺
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Redis 基础你掌握多少了？来个查漏补缺
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#nosql" class="md-nav__link">
    NoSQL 是什么
  </a>
  
    <nav class="md-nav" aria-label="NoSQL 是什么">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#redis_1" class="md-nav__link">
    Redis 通用命令
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    过期时间
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#redis_2" class="md-nav__link">
    Redis 的五种基本数据类型
  </a>
  
    <nav class="md-nav" aria-label="Redis 的五种基本数据类型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#string" class="md-nav__link">
    字符串 string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hash" class="md-nav__link">
    hash
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list" class="md-nav__link">
    list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set" class="md-nav__link">
    set
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zset" class="md-nav__link">
    zset
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#redis_3" class="md-nav__link">
    Redis 中的事务和管道
  </a>
  
    <nav class="md-nav" aria-label="Redis 中的事务和管道">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pipeline" class="md-nav__link">
    管道 Pipeline
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    事务
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../2Redis_interview/" class="md-nav__link">
        40 道Redis面试题
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../4Redis_int_all/" class="md-nav__link">
        115 道 Redis 面试题解答
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../5redis6_int/" class="md-nav__link">
        Redis6.0与缓存大全基础面试
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#nosql" class="md-nav__link">
    NoSQL 是什么
  </a>
  
    <nav class="md-nav" aria-label="NoSQL 是什么">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#redis_1" class="md-nav__link">
    Redis 通用命令
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    过期时间
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#redis_2" class="md-nav__link">
    Redis 的五种基本数据类型
  </a>
  
    <nav class="md-nav" aria-label="Redis 的五种基本数据类型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#string" class="md-nav__link">
    字符串 string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hash" class="md-nav__link">
    hash
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list" class="md-nav__link">
    list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set" class="md-nav__link">
    set
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zset" class="md-nav__link">
    zset
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#redis_3" class="md-nav__link">
    Redis 中的事务和管道
  </a>
  
    <nav class="md-nav" aria-label="Redis 中的事务和管道">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pipeline" class="md-nav__link">
    管道 Pipeline
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    事务
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/Chao-Xi/jxredisbook.git/edit/master/docs/chap10/3Redis_basic.md" title="编辑此页" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>



<h1 id="redis"><strong>Redis 基础你掌握多少了？来个查漏补缺</strong></h1>
<p><img alt="Alt Image Text" src="../../images/3_1.png" title="Body image" /></p>
<p><code>Redis</code> 是开源，内存中的数据结构存储系统，它可以用<strong>作数据库、缓存和消息中间件</strong>。</p>
<p>它支持多种类型的数据结构，如字符串 <code>strings</code>，散列<code>hashes</code>，列表 <code>lists</code>，集合 <code>sets</code>，有序集合 <code>sorted sets</code> 与范围查询， <code>bitmaps</code>，<code>hyperloglogs</code> 和 地理空间（geospatial）索引半径查询。</p>
<p><strong><span style="color:red">Redis 还内置了复制（<code>replication</code>），LUA脚本（<code>Lua scripting</code>）， LRU驱动事件（<code>LRU eviction</code>），事务（<code>transactions</code>）和不同级别的磁盘持久化（<code>persistence</code>），并通过 <code>Redis</code> 哨兵（<code>Sentinel</code>）和自动分区（<code>Cluster</code>）提供高可用性（<code>high availability</code>）</span></strong>。</p>
<h2 id="nosql"><strong>NoSQL 是什么</strong></h2>
<p>我们知道 Redis 是一种非关系型数据库 NoSQL。而为什么出现 NoSQL？NoSQL 又是什么呢？</p>
<p>单机数据库的年代</p>
<p>在一个网站访问量不大的时候，我们使用一个数据库就足以应对流量请求。</p>
<p><img alt="Alt Image Text" src="../../images/3_2.png" title="Body image" /></p>
<p><strong>缓存 + 拆分</strong></p>
<p>随着访问量的上升，一个数据库已经不能满足我们的需求了。为了更高的性能，我们在中间加上了一个缓存层并且将数据库做了<strong>集群、结构优化和读写分离</strong>。</p>
<p><img alt="Alt Image Text" src="../../images/3_3.png" title="Body image" /></p>
<p>而这里的缓存就是 <code>NoSQL</code>，当然做缓存也只是 <code>NoSQL</code> 的一种功能，就像 <code>Redis</code> 并不仅仅有缓存这一种功能。</p>
<p>比如它还能实现 简单的消息队列，解决 <code>Session</code> 共享，计数器，排行榜，好友关系处理 等等功能，可见 <code>Redis</code> 是一个非常强大工具，让我们来学习它吧！</p>
<h3 id="redis_1"><strong>Redis 通用命令</strong></h3>
<p>首先我们抛开数据类型来讲关于 Redis 的通用命令。</p>
<p><img alt="Alt Image Text" src="../../images/3_4.png" title="Body image" /></p>
<p><strong>操作 <code>key</code> 和<code>value</code></strong></p>
<p><code>Redis</code> 是一种 <code>key value</code> 存储的缓存数据库，所有的数据都有一个自己唯一的<code>key</code>。</p>
<p>这里为了方便演示，我使用了字符串相关的设置命令。</p>
<ul>
<li><code>keys [pattern]</code> 获取符合要求的所有<code>key</code>。时间复杂度为 <code>O(n)</code>，一般在生产环境中不使用，因为<strong><code>Redis</code> 是单线程</strong>的，<strong>执行耗时的任务会阻塞其他任务</strong>。一般会使用 <code>scan</code> 命令替代（非阻塞）。</li>
</ul>
<pre><code>$ kubectl exec -it redis redis-cli -n redis
127.0.0.1:6379&gt; keys *
(empty list or set)
127.0.0.1:6379&gt; set username jxi
OK
127.0.0.1:6379&gt; keys *
1) &quot;username&quot;
127.0.0.1:6379&gt; set username1 jane
OK
127.0.0.1:6379&gt; keys *
1) &quot;username1&quot;
2) &quot;username&quot;
127.0.0.1:6379&gt; keys u*
1) &quot;username1&quot;
2) &quot;username&quot;
127.0.0.1:6379&gt; keys username1*
1) &quot;username1&quot;
</code></pre>
<ul>
<li><code>dbsize</code> 获取当前存储数据个数。</li>
<li><code>exists key</code> 判断是否存在该key</li>
<li><code>del key</code> 删除指定数据</li>
<li><code>type key</code> 获取指定key的数据类型</li>
<li><code>rename key newkey</code> 重命名</li>
</ul>
<pre><code>127.0.0.1:6379&gt; dbsize
(integer) 2
127.0.0.1:6379&gt; exists username
(integer) 1
127.0.0.1:6379&gt; exists user
(integer) 0
127.0.0.1:6379&gt; del username
(integer) 1
127.0.0.1:6379&gt; keys *
1) &quot;username1&quot;
127.0.0.1:6379&gt; type username1
string
127.0.0.1:6379&gt; rename username1 username
OK
127.0.0.1:6379&gt; keys *
1) &quot;username&quot;
</code></pre>
<h3 id="_1"><strong>过期时间</strong></h3>
<p><code>Redis</code> 中很多数据都是用来作为<strong>缓存数据</strong>的，而作为缓存就需要有过期时间，在 <code>Redis</code> 中提供了很强大的<strong>过期时间</strong>设置功能。</p>
<ul>
<li><code>expire key seconds</code> 为某个 <code>key</code> 设置过期时间。</li>
<li><code>ttl key</code> 查看某个 key 的剩余时间，返回正数代表剩余的时间，<strong><span style="color:red"><code>-1</code>代表永久，<code>-2</code>代表已过期或不存在。</span></strong></li>
</ul>
<pre><code>127.0.0.1:6379&gt; expire username 10
(integer) 1
127.0.0.1:6379&gt; ttl username
(integer) 6
127.0.0.1:6379&gt; ttl username
(integer) 4
127.0.0.1:6379&gt; ttl username
(integer) 3
127.0.0.1:6379&gt; ttl username
(integer) 2
127.0.0.1:6379&gt; ttl username
(integer) 1
127.0.0.1:6379&gt; ttl username
(integer) -2

127.0.0.1:6379&gt; set ttl 123
OK
127.0.0.1:6379&gt; ttl ttl
(integer) -1
</code></pre>
<h2 id="redis_2"><strong>Redis 的五种基本数据类型</strong></h2>
<p>在上面我说到了很多 <code>Redis</code> 作为缓存能实现的其他功能，比如计数器，排行榜，好友关系等，这些实现的依据就是靠着 <code>Redis</code> 的数据结构。在整个 <code>Redis</code> 中一共有五种基本的数据结构(还有些高级数据结构以后会讲)，他们分别是 <strong>字符串<code>strings</code>， 散列 <code>hashes</code>， 列表 <code>lists</code>， 集合 <code>sets</code>， 有序集合<code>sorted sets</code></strong>。</p>
<h3 id="string"><strong>字符串 string</strong></h3>
<p>在绝大部分编程语言中都有 <code>String</code> 字符串类型，对于作为数据库的 <code>Redis</code> 也是必不可少的。</p>
<p><img alt="Alt Image Text" src="../../images/3_5.png" title="Body image" /></p>
<ul>
<li><code>set key value</code> 设置值</li>
<li><code>get key</code> 获取某个<code>key</code>的值</li>
<li><code>mset key1 value1 key2 value2</code> 批量设置并且是<strong>原子</strong>的，可以用来减少网络时间消耗</li>
<li><code>mget key1 key2</code>批量获取并且是原子的，可以用来减少网络时间消耗</li>
</ul>
<pre><code>127.0.0.1:6379&gt; set username1 Jane
OK
127.0.0.1:6379&gt; set username2 Jacob
OK
127.0.0.1:6379&gt; del username2
(integer) 1
127.0.0.1:6379&gt; mset username2 Jacob username3 Jason
OK
127.0.0.1:6379&gt; get username1
&quot;Jane&quot;

127.0.0.1:6379&gt; mget username1 username2 username3
1) &quot;Jane&quot;
2) &quot;Jacob&quot;
3) &quot;Jason&quot;
</code></pre>
<ul>
<li><code>incr key</code> 自增指定key的值</li>
<li><code>decr key</code> 自减指定key的值</li>
<li><code>incrby key value</code>自增指定数值</li>
<li><code>decrby key value</code> 自减指定数值</li>
<li><code>incrbyfloat key floatvalue</code> 增加指定浮点数,前面几个操作就可以用来实现<strong>计数器</strong>的功能。</li>
</ul>
<pre><code>127.0.0.1:6379&gt; set counter 1
OK
127.0.0.1:6379&gt; incr counter
(integer) 2
127.0.0.1:6379&gt; decr counter
(integer) 1
127.0.0.1:6379&gt; get counter
&quot;1&quot;
127.0.0.1:6379&gt; incrby counter 99
(integer) 100
127.0.0.1:6379&gt; get counter
&quot;100&quot;
127.0.0.1:6379&gt; decrby counter 100
(integer) 0
127.0.0.1:6379&gt; get counter
&quot;0&quot;
127.0.0.1:6379&gt; incrbyfloat counter 0.5
&quot;0.5&quot;
127.0.0.1:6379&gt; get counter
&quot;0.5&quot;
</code></pre>
<ul>
<li><code>setnx key value</code> <strong>如果不存在该<code>key</code>则可以设置成功，否则会失败</strong>，<span style="color:red"><strong>加上过期时间限制，则是redis实现分布式锁的一种方式</strong>（后面会提到）</span>。</li>
<li><strong><code>set key value xx</code> 与前面相反，如果存在则设置成功</strong>，否则失败(相当于更新操作)</li>
</ul>
<pre><code>27.0.0.1:6379&gt; keys *
1) &quot;username2&quot;
2) &quot;counter&quot;
3) &quot;ttl&quot;
4) &quot;username3&quot;
5) &quot;username1&quot;
127.0.0.1:6379&gt; setnx username1 tt
(integer) 0
127.0.0.1:6379&gt; get username1
&quot;Jane&quot;

127.0.0.1:6379&gt; setnx username4 john
(integer) 1
127.0.0.1:6379&gt; get username4
&quot;john&quot;

127.0.0.1:6379&gt; set username5 jack xx
(nil)
127.0.0.1:6379&gt; get username5
(nil)
127.0.0.1:6379&gt; set username4 jack xx
OK
127.0.0.1:6379&gt; get username4
&quot;jack&quot;
</code></pre>
<ul>
<li><code>getset key newvalue</code> 设置新值并返回旧值</li>
<li><code>append key value</code> 为原本内容追加内容</li>
<li><code>strlen key</code> 获取字符串长度</li>
<li><code>getrange key start end</code> 获取指定范围的内容</li>
<li><code>setrange key index value</code> 设置指定范围的内容</li>
</ul>
<pre><code>127.0.0.1:6379&gt; keys *
1) &quot;username4&quot;
2) &quot;username2&quot;
3) &quot;counter&quot;
4) &quot;ttl&quot;
5) &quot;username3&quot;
6) &quot;username1&quot;

127.0.0.1:6379&gt; get username1
&quot;Jane&quot;

127.0.0.1:6379&gt; getset username1 JaneDoe
&quot;Jane&quot;
127.0.0.1:6379&gt; get username1
&quot;JaneDoe&quot;

127.0.0.1:6379&gt; append username1 love
(integer) 11
127.0.0.1:6379&gt; get username1
&quot;JaneDoelove&quot;

127.0.0.1:6379&gt; strlen username1
(integer) 11

127.0.0.1:6379&gt; getrange username1 0 5
&quot;JaneDo&quot;
127.0.0.1:6379&gt; setrange username1 5 s
(integer) 11
127.0.0.1:6379&gt; get username1
&quot;JaneDselove&quot;
</code></pre>
<ul>
<li><code>setex key seconds value</code>设置值且设置过期时间</li>
<li><code>set key value ex seconds nx</code> 为不存在的<code>key</code>设置值且设置过期时间，<strong>分布式锁的实现方式</strong>。</li>
</ul>
<pre><code>127.0.0.1:6379&gt; keys *
1) &quot;username4&quot;
2) &quot;username2&quot;
3) &quot;counter&quot;
4) &quot;ttl&quot;
5) &quot;username3&quot;
6) &quot;username1&quot;
127.0.0.1:6379&gt; setex user 10 jac
OK

127.0.0.1:6379&gt; ttl user
(integer) 6

127.0.0.1:6379&gt; ttl user
(integer) 2

127.0.0.1:6379&gt; set user1 snow ex seconds nx
OK
127.0.0.1:6379&gt; ttl user1
(integer) 5
127.0.0.1:6379&gt; ttl user1
(integer) 2

127.0.0.1:6379&gt; set username1 snow ex 10 nx
(nil)
</code></pre>
<h3 id="hash"><strong>hash</strong></h3>
<p><img alt="Alt Image Text" src="../../images/3_6.png" title="Body image" /></p>
<p>其实我们可以理解 <code>hash</code> 为 <strong>小型Redis </strong>，<code>Redis</code>在底层实现上和 <code>Java</code> 中的<code>HashMap</code>差不多，都是使用 <strong>数组 + 链表</strong> 的二维结构实现的。</p>
<p><img alt="Alt Image Text" src="../../images/3_7.png" title="Body image" /></p>
<p>不同的是，在<code>Redis</code> 中字典的值<strong>只能是字符串</strong>，而且他们 <code>rehash</code> 的方式不一样，在 <code>Redis</code> 中使用的是 <strong>渐进式rehash</strong>。</p>
<blockquote>
<p>在 <code>rehash</code> 的时候会保留新旧两个 <code>hash</code> 字典，在数据迁移的时候会将旧字典中的内容一点一点迁移到新字典中，查询的同时会查询两个 <code>hash</code> 字典，等数据全部迁移完成才会将新字典代替就字典。</p>
</blockquote>
<p>下面我们来看一下关于 <code>hash</code> 的基本操作。</p>
<ul>
<li><code>hset key field value</code> 设置字典中某个<code>key</code>的值</li>
<li><code>hsetnx key field value</code> 设置字典中某个<code>key</code>的值(不存在的)</li>
<li><code>hmset key field1 value1 field2 value2</code> ... 批量设置</li>
<li><code>hget key field</code>获取字典中某个key的值</li>
<li><code>hmget key field1 field2</code> 批量获取</li>
<li><code>hgetall key</code> 获取全部</li>
</ul>
<pre><code>$ kubectl exec -it redis redis-cli -n redis 
127.0.0.1:6379&gt; hset userInfo name jacob
(integer) 1
127.0.0.1:6379&gt; hset userInfo name jane
(integer) 0

127.0.0.1:6379&gt; hsetnx userInfo name jane
(integer) 0

127.0.0.1:6379&gt; hsetnx userInfo qq 11111
(integer) 1
127.0.0.1:6379&gt; hmset userInfo wecht we111 email 111@qq.com
OK

127.0.0.1:6379&gt; hget userInfo wecht
&quot;we111&quot;
127.0.0.1:6379&gt; hmget userInfo qq email
1) &quot;11111&quot;
2) &quot;111@qq.com&quot;

127.0.0.1:6379&gt; hgetall userInfo
1) &quot;name&quot;
2) &quot;jane&quot;
3) &quot;qq&quot;
4) &quot;11111&quot;
5) &quot;wecht&quot;
6) &quot;we111&quot;
7) &quot;email&quot;
8) &quot;111@qq.com&quot;
</code></pre>
<ul>
<li><code>hdel key field</code> 删除某个<code>key</code></li>
<li><code>hexists key field</code> 判断是否存在</li>
<li><code>hlen key</code> 获取指定key对应的字典中的存储个数</li>
<li><code>hvals key</code> 返回所有的<code>value</code></li>
<li><code>hkeys key</code> 返回所有的key</li>
</ul>
<pre><code>127.0.0.1:6379&gt; hkeys userInfo
1) &quot;name&quot;
2) &quot;qq&quot;
3) &quot;wecht&quot;
4) &quot;email&quot;
127.0.0.1:6379&gt; hdel userInfo name
(integer) 1

127.0.0.1:6379&gt; hkeys userInfo
1) &quot;qq&quot;
2) &quot;wecht&quot;
3) &quot;email&quot;

127.0.0.1:6379&gt; hexists userInfo qq
(integer) 1

127.0.0.1:6379&gt; hlen userInfo
(integer) 3
127.0.0.1:6379&gt; hvals hvals
(empty list or set)

127.0.0.1:6379&gt; hvals userInfo
1) &quot;11111&quot;
2) &quot;we111&quot;
3) &quot;111@qq.com&quot;
</code></pre>
<ul>
<li><code>hincrby key field increValue</code> 增加某个value的值(也可以增加负数)</li>
<li><code>hincrbyfloat key field floatValue</code> 增加某个value的值(浮点数)</li>
</ul>
<pre><code>127.0.0.1:6379&gt; hset userInfo age 29
(integer) 1
127.0.0.1:6379&gt; hincrby userInfo age 1
(integer) 30
127.0.0.1:6379&gt; hget userInfo age
&quot;30&quot;


127.0.0.1:6379&gt; hincrbyfloat userInfo age 0.1
&quot;30.1&quot;

127.0.0.1:6379&gt; hget userInfo age
&quot;30.1&quot;
</code></pre>
<h3 id="list"><strong>list</strong></h3>
<p><code>Redis</code> 中的列表相当于 <code>Java</code> 中的 <code>LinkedList</code>(双向链表) ，也就是底层是通过 <strong>链表</strong> 来实现的，所以对于 <code>list</code> 来说 <strong>插入删除操作很快，但 索引定位非常慢</strong>。</p>
<p><img alt="Alt Image Text" src="../../images/3_8.png" title="Body image" /></p>
<p><code>Redis</code> 提供了许多对于  <code>list</code> 的操作，如<strong>出，入</strong>等操作，你可以充分利用它们来实现一个<strong>栈</strong> 或者 <strong>队列</strong>。</p>
<p><img alt="Alt Image Text" src="../../images/3_9.png" title="Body image" /></p>
<p>下面我们来看一下关于 list 的基本操作。</p>
<ul>
<li><code>lpush key item1 item2 item3</code>... 从左入栈</li>
<li><code>rpush key item1 item2 item3</code>... 从右入栈</li>
<li><code>lpop key</code> 从左出栈</li>
<li><code>rpop key</code> 从右出栈</li>
<li><code>lindex key index</code> 获取指定索引的元素 <code>O(n)</code>谨慎使用</li>
<li><code>lrange key start end</code> 获取指定范围的元素 <code>O(n)</code>谨慎使用</li>
</ul>
<pre><code>127.0.0.1:6379&gt; lpush userlist jacob
(integer) 1
127.0.0.1:6379&gt; lpush userlist jane john
(integer) 3
127.0.0.1:6379&gt; lrange userlist 0 -1  # -1 代表末尾
1) &quot;john&quot;
2) &quot;jane&quot;
3) &quot;jacob&quot;
127.0.0.1:6379&gt; rpush userlist jake
(integer) 4
127.0.0.1:6379&gt; lrange userlist 0 -1
1) &quot;john&quot;
2) &quot;jane&quot;
3) &quot;jacob&quot;
4) &quot;jake&quot;
127.0.0.1:6379&gt; lpop userlist
&quot;john&quot;
127.0.0.1:6379&gt; rpop userlist
&quot;jake&quot;
127.0.0.1:6379&gt; lrange userlist 0 -1
1) &quot;jane&quot;
2) &quot;jacob&quot;
127.0.0.1:6379&gt; lindex userlist 1
&quot;jacob&quot;
127.0.0.1:6379&gt; 
</code></pre>
<ul>
<li><code>linsert key before|after item newitem</code> 在指定元素的前面或者后面添加新元素</li>
<li><code>lrem key count value</code> 删除指定个数值为<code>value</code>的元素<ul>
<li><code>count = 0</code> :删除所有值为<code>value</code>的元素</li>
<li><code>count &gt; 0</code> :从左到右删除<code>count</code> 个值为 <code>value</code> 的元素</li>
<li><code>count &lt; 0</code> :从右到做删除 <code>|count|</code>个值为<code>value</code> 的元素</li>
</ul>
</li>
<li><code>ltrim key start end</code> 保留指定范围的元素</li>
<li><code>lset key index newValue</code> 更新某个索引的值</li>
</ul>
<pre><code>127.0.0.1:6379&gt; lrange userlist 0 -1
1) &quot;jane&quot;
2) &quot;jacob&quot;


127.0.0.1:6379&gt; linsert userlist before jacob jake
(integer) 3
127.0.0.1:6379&gt; lrange userlist 0 -1
1) &quot;jane&quot;
2) &quot;jake&quot;
3) &quot;jacob&quot;

127.0.0.1:6379&gt; linsert userlist after jacob john
(integer) 4
127.0.0.1:6379&gt; lrange userlist 0 -1
1) &quot;jane&quot;
2) &quot;jake&quot;
3) &quot;jacob&quot;
4) &quot;john&quot;

127.0.0.1:6379&gt; lrem userlist 0 jacob
(integer) 1
127.0.0.1:6379&gt; lrange userlist 0 -1
1) &quot;jane&quot;
2) &quot;jake&quot;
3) &quot;john&quot;

127.0.0.1:6379&gt; lpush userlist jacob
(integer) 4
127.0.0.1:6379&gt; lrange userlist 0 -1
1) &quot;jacob&quot;
2) &quot;jane&quot;
3) &quot;jake&quot;
4) &quot;john&quot;
127.0.0.1:6379&gt; lrange userlist 2 jane
(error) ERR value is not an integer or out of range
127.0.0.1:6379&gt; lrem userlist 2 jane
(integer) 1
127.0.0.1:6379&gt; lrange userlist 0 -1
1) &quot;jacob&quot;
2) &quot;jake&quot;
3) &quot;john&quot;


127.0.0.1:6379&gt; lpush userlist jacob
(integer) 4
127.0.0.1:6379&gt; lrange userlist 0 -1
1) &quot;jacob&quot;
2) &quot;jacob&quot;
3) &quot;jake&quot;
4) &quot;john&quot;
127.0.0.1:6379&gt; lrem userlist 2 jacob
(integer) 2
127.0.0.1:6379&gt; lrange userlist 0 -1
1) &quot;jake&quot;
2) &quot;john&quot;

127.0.0.1:6379&gt; ltrim userlist 0 1
OK
127.0.0.1:6379&gt; lrange userlist 0 -1
1) &quot;jake&quot;
2) &quot;john&quot;

127.0.0.1:6379&gt; lset userlist 0 jason
OK
127.0.0.1:6379&gt; lrange userlist 0 -1
1) &quot;jason&quot;
2) &quot;john&quot;
</code></pre>
<ul>
<li><code>blpop key timeout</code> 没有则阻塞(<code>timeout</code>指定阻塞时间 为<code>0</code>代表永久)</li>
<li><code>brpop key timeout</code>没有则阻塞(<code>timeout</code>指定阻塞时间 为<code>0</code>代表永久) 这两个可以用来实现消费者生产者</li>
</ul>
<pre><code>127.0.0.1:6379&gt; lpush messagelist message1  #生产者存入消息
(integer) 1
127.0.0.1:6379&gt; lpush messagelist message2
(integer) 2

127.0.0.1:6379&gt; rpop messagelist  #消费者获得消息
&quot;message1&quot;

127.0.0.1:6379&gt; brpop messagelist 0 #消费者获得消息（此时为空阻塞）
1) &quot;messagelist&quot;                            # 此时监听到有消息返回
2) &quot;message2&quot;
</code></pre>
<p>总结来说我们可以使用 <strong>左入又出或者右入左出 来实现队列，左入左出或者右入右出 来实现栈</strong>。</p>
<ul>
<li>lpush + lpop = Stack</li>
<li>rpush + rpop = Stack**</li>
<li>lpush + rpop = Queue</li>
<li>rpush + lpop = Queue</li>
<li>lpush/rpush + ltrim = Capped List (定长列表)</li>
<li>lpush + brpop = Message Queue (消息队列)</li>
<li>rpush + blpop = Message Queue (消息队列)</li>
</ul>
<h3 id="set"><strong>set</strong></h3>
<p><code>Redis</code> 中的<code>set</code> 相当于 <code>Java</code> 中的 <code>HashSet(无序集合</code>)，其中里面的元素<strong>不可以重复</strong>，我们可以利用它实现一些去重的功能。我们还有对几个集合进行<strong>取交集，取并集</strong>等操作，这些操作就可以获取不同用户之间的共同好友，共同爱好等等。</p>
<p><img alt="Alt Image Text" src="../../images/3_10.png" title="Body image" /></p>
<p>下面我们就来看一下关于 set 的一些基本操作。</p>
<ul>
<li><code>sadd key value</code> 添加元素</li>
<li><code>sdel key value</code> 删除某个元素</li>
<li><code>sismember key value</code> 判断是否是集合中的元素</li>
<li><code>srandmember key count</code> 随机获取指定个数的元素(不会影响集合结构)</li>
<li><code>spop key count</code> 从集合中随机弹出元素(会破坏结合结构)</li>
<li><code>smembers key</code> 获取集合所有元素<code>O(n)</code>复杂度</li>
<li><code>scard key</code> 获取集合个数</li>
</ul>
<pre><code>127.0.0.1:6379&gt; sadd userset jacob
(integer) 1
127.0.0.1:6379&gt; sadd userset jacob
(integer) 0
127.0.0.1:6379&gt; sadd userset jane
(integer) 1
127.0.0.1:6379&gt; sismember userset john
(integer) 0
127.0.0.1:6379&gt; sismember userset jacob
(integer) 1
127.0.0.1:6379&gt; sismember userset 1
(integer) 0
127.0.0.1:6379&gt; srandmember userset 1
1) &quot;jacob&quot;
127.0.0.1:6379&gt; smembers userset
1) &quot;jacob&quot;
2) &quot;jane&quot;
127.0.0.1:6379&gt; spop userset 1
1) &quot;jane&quot;
127.0.0.1:6379&gt; smembers userset
1) &quot;jacob&quot;
127.0.0.1:6379&gt; scard userset
(integer) 1
</code></pre>
<ul>
<li><code>sinter set1 set2</code> ... 获取所有集合中的交集</li>
<li><code>sdiff set1 set2</code> ... 获取所有集合中的差集</li>
<li><code>sunion set1 set2</code> ... 获取所有集合中的并集</li>
</ul>
<pre><code>127.0.0.1:6379&gt; sadd set1 jacob jane john
(integer) 3
127.0.0.1:6379&gt; sadd set2 jason jake jane
(integer) 3

127.0.0.1:6379&gt; sdiff set1 set2
1) &quot;jacob&quot;
2) &quot;john&quot;

127.0.0.1:6379&gt; sunion set1 set2
1) &quot;jane&quot;
2) &quot;john&quot;
3) &quot;jake&quot;
4) &quot;jacob&quot;
5) &quot;jason&quot;
</code></pre>
<h3 id="zset"><strong>zset</strong></h3>
<p><code>Redis</code>中的 <code>zset</code> 是一个 <strong>有序集合</strong>，通过它可以实现很多有意思的功能，比如学生成绩排行榜，视频播放量排行榜等等。</p>
<p><img alt="Alt Image Text" src="../../images/3_11.png" title="Body image" /></p>
<p><code>zset</code> 中是使用 <strong>跳表</strong> 来实现的，我们知道只有数组这种连续的空间才能使用<strong>二分查找</strong>进行快速的定位，而链表是不可以的。跳表帮助链表查找的时候节省了很多时间(使用跳的方式来遍历索引来进行有序插入)，如果不了解跳表的同学可以补习一下。</p>
<p><img alt="Alt Image Text" src="../../images/3_12.png" title="Body image" /></p>
<p>下面我们来看一下关于 <code>zset</code> 的一些基本操作。</p>
<ul>
<li><code>zadd key score element</code> 添加，score用于排序，value需要唯一，由于使用的跳表，时间复杂度为 O(logn)。</li>
<li><code>zrem key element</code> 删除某元素 O(1)时间复杂度</li>
<li><code>zscore key element</code> 获取某个元素的分数</li>
<li><code>zincrby key incrScore element</code> 增加某个元素的分数</li>
<li><code>zrange key start end [withscores]</code> 获取指定索引范围的元素 加上<code>withscores</code>则返回分数 <strong>O(logn + m)时间复杂度</strong></li>
<li><code>zrangebyscore key minScore maxScore [withscores]</code>获取指定分数范围的元素 加上withscores则返回分数，<strong>O(logn + m)时间复杂度</strong></li>
<li><code>zcard key</code> 获取有序集合长度</li>
</ul>
<pre><code>127.0.0.1:6379&gt; zadd mathTest 88 mike
(integer) 1
127.0.0.1:6379&gt; zadd mathTest 99 tony
(integer) 1
127.0.0.1:6379&gt; zadd mathTest 66 zend
(integer) 1
127.0.0.1:6379&gt; zadd mathTest 77 yake
(integer) 1

127.0.0.1:6379&gt; zrange mathTest 0 -1
1) &quot;zend&quot;
2) &quot;yake&quot;
3) &quot;mike&quot;
4) &quot;tony&quot;

127.0.0.1:6379&gt; zrangebyscore mathTest 0 100
1) &quot;zend&quot;
2) &quot;yake&quot;
3) &quot;mike&quot;
4) &quot;tony&quot;

127.0.0.1:6379&gt; zincrby mathTest 10 yake
&quot;87&quot;
127.0.0.1:6379&gt; zrange mathTest 0 -1
1) &quot;zend&quot;
2) &quot;yake&quot;
3) &quot;mike&quot;
4) &quot;tony&quot;

127.0.0.1:6379&gt; zrange mathTest 0 -1 withscores
1) &quot;zend&quot;
2) &quot;66&quot;
3) &quot;yake&quot;
4) &quot;87&quot;
5) &quot;mike&quot;
6) &quot;88&quot;
7) &quot;tony&quot;
8) &quot;99&quot;

127.0.0.1:6379&gt; zrem mathTest zend
(integer) 1
127.0.0.1:6379&gt; zcard mathTest
(integer) 3
</code></pre>
<h2 id="redis_3"><strong>Redis 中的事务和管道</strong></h2>
<h3 id="pipeline"><strong>管道 Pipeline</strong></h3>
<p>在某些场景下我们在<strong>一次操作中可能需要执行多个命令</strong>，而如果我们只是一个命令一个命令去执行则会浪费很多网络消耗时间，如果将命令一次性传输到 <code>Redis</code> 中去再执行，则会减少很多开销时间。</p>
<p>但是需要注意的是 <code>pipeline</code>中的命令并不是原子性执行的，也就是说管道中的命令到达 <code>Redis</code>服务器的时候可能会被其他的命令穿插。</p>
<p><img alt="Alt Image Text" src="../../images/3_13.png" title="Body image" /></p>
<p><img alt="Alt Image Text" src="../../images/3_14.png" title="Body image" /></p>
<h3 id="_2"><strong>事务</strong></h3>
<p>关系型数据库具有 <code>ACID</code> 特性，<code>Redis</code> 能保证<code>A（原子性）和I（隔离性）</code>，D（持久性）看是否有配置 <code>RDB</code>或者 <code>AOF</code> <strong>持久化操作</strong>，但无法保证一致性，因为 <strong><code>Redis</code> 事务不支持回滚</strong>。</p>
<p>我们可以简单理解为 <code>Redis</code> 中的事务只是比 <code>Pipeline</code> 多了个原子性操作，也就是不会被其他命令给分割，如上图。</p>
<ul>
<li>
<p><code>multi</code> 事务开始的标志</p>
</li>
<li>
<p><code>exec</code> 事务执行</p>
</li>
</ul>
<pre><code>127.0.0.1:6379&gt; multi                             #开始执行
OK
127.0.0.1:6379&gt; zadd userset 88 jake     # 添加操作
QUEUED
127.0.0.1:6379&gt; zrange userset 0 -1       #提交
QUEUED
127.0.0.1:6379&gt;  exec
</code></pre>
<ul>
<li><code>discard</code> 清除在这个事务中放入队列的所有命令，即解除整个事务。</li>
<li><code>watch key</code> 在事务开始前监控某个元素，如果在提交事务的时候发现这个元素的值被其他客户端更改了则事务会运行失败。</li>
<li><code>unwatch key</code> 解除监控</li>
</ul>
<p><img alt="Alt Image Text" src="../../images/3_15.png" title="Body image" /></p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="页脚">
      
        
        <a href="../1redis_test/" class="md-footer__link md-footer__link--prev" aria-label="上一页: Redis 核心技术考题" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                上一页
              </span>
              Redis 核心技术考题
            </div>
          </div>
        </a>
      
      
        
        <a href="../2Redis_interview/" class="md-footer__link md-footer__link--next" aria-label="下一页: 40 道Redis面试题" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                下一页
              </span>
              40 道Redis面试题
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2021-9999 Jacob Xi
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "\u590d\u5236", "clipboard.copied": "\u5df2\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.term.missing": "\u7f3a\u5c11", "select.version.title": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "search": "../../assets/javascripts/workers/search.bd0b6b67.min.js"}</script>
    
    
      <script src="../../assets/javascripts/bundle.467223ff.min.js"></script>
      
    
  </body>
</html>